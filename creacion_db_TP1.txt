CREATE DATABASE COMERCIO;

USE COMERCIO;

CREATE TABLE PAISES
(
PAIS INT,
descripcion VARCHAR(100) NOT NULL,
CONSTRAINT PK_PAIS PRIMARY KEY (PAIS),
CONSTRAINT UNIQUE_DESC UNIQUE (descripcion)
)


INSERT INTO PAISES (PAIS, descripcion) VALUES (1, 'ARGENTINA');
INSERT INTO PAISES (PAIS, descripcion) VALUES (2, 'BRASIL');
INSERT INTO PAISES (PAIS, descripcion) VALUES (3, 'CANADA');
INSERT INTO PAISES (PAIS, descripcion) VALUES (4, 'AUSTRALIA');
INSERT INTO PAISES (PAIS, descripcion) VALUES (5, 'CAMERUN');

SELECT PAIS, descripcion FROM PAISES ORDER BY descripcion ASC;



CREATE TABLE CONDICION_FISCAL
(
C_FISCAL INT,
descripcion VARCHAR(100) NOT NULL,
porcentaje FLOAT NOT NULL,
CONSTRAINT PK_C_FISCAL PRIMARY KEY (C_FISCAL)
)

INSERT INTO dbo.CONDICION_FISCAL (C_FISCAL, descripcion, porcentaje) VALUES (1, 'RESPONSABLE INSCRIPTO',0.21);
INSERT INTO dbo.CONDICION_FISCAL (C_FISCAL, descripcion, porcentaje) VALUES (2, 'RESPONSABLE NO INSCRIPTO',0.21);
INSERT INTO dbo.CONDICION_FISCAL (C_FISCAL, descripcion, porcentaje) VALUES (3, 'EXENTO',0.7);

UPDATE dbo.CONDICION_FISCAL SET descripcion = 'RESPONSABLE NO INSCRIPTO', porcentaje = 0.15 WHERE C_FISCAL = 2;

SELECT * FROM dbo.CONDICION_FISCAL;



CREATE TABLE PRODUCTOS
(
PRODUCTO INT,
descripcion VARCHAR(100) NOT NULL
CONSTRAINT PK_PRODUCTO PRIMARY KEY (PRODUCTO)
)


INSERT INTO dbo.PRODUCTOS (PRODUCTO, descripcion) VALUES (1,'LAPICERA ROLLING BALL');
INSERT INTO dbo.PRODUCTOS (PRODUCTO, descripcion) VALUES (2,'CUADERNO 80 HOJAS');
INSERT INTO dbo.PRODUCTOS (PRODUCTO, descripcion) VALUES (3,'LAPIZ DIBUJO TECNICO');
INSERT INTO dbo.PRODUCTOS (PRODUCTO, descripcion) VALUES (4,'CARTUCHERA 30 ML');
INSERT INTO dbo.PRODUCTOS (PRODUCTO, descripcion) VALUES (5,'SACAPUNTAS');
INSERT INTO dbo.PRODUCTOS (PRODUCTO, descripcion) VALUES (6,'MARCADOR FLUOR');
INSERT INTO dbo.PRODUCTOS (PRODUCTO, descripcion) VALUES (7,'REGLA 50 CM');

SELECT * FROM dbo.PRODUCTOS;



CREATE TABLE TIPOS_DOCUMENTOS
(
TIPO_DOCUMENTO INT,
descripcion VARCHAR(100) NOT NULL,
CONSTRAINT PK_TIPO_DOCUMENTO PRIMARY KEY (TIPO_DOCUMENTO)
)


INSERT INTO dbo.TIPOS_DOCUMENTOS (TIPO_DOCUMENTO, descripcion) VALUES (1,'DNI');
INSERT INTO dbo.TIPOS_DOCUMENTOS (TIPO_DOCUMENTO, descripcion) VALUES (2,'CI');
INSERT INTO dbo.TIPOS_DOCUMENTOS (TIPO_DOCUMENTO, descripcion) VALUES (3,'LE');
INSERT INTO dbo.TIPOS_DOCUMENTOS (TIPO_DOCUMENTO, descripcion) VALUES (4,'PAS');
INSERT INTO dbo.TIPOS_DOCUMENTOS (TIPO_DOCUMENTO, descripcion) VALUES (5,'LC');

SELECT * FROM dbo.TIPOS_DOCUMENTOS;



CREATE TABLE STOCKS
(
FECHA DATETIME,
PRODUCTO INT,
cantidad INT NOT NULL,
CONSTRAINT PK_FECHA_PRODUCTO PRIMARY KEY (FECHA,PRODUCTO),
CONSTRAINT FK_PRODUCTO FOREIGN KEY (PRODUCTO) REFERENCES PRODUCTOS(PRODUCTO)
)


INSERT INTO dbo.STOCKS (FECHA, PRODUCTO, cantidad) VALUES ('23/04/2014',1,3000);
INSERT INTO dbo.STOCKS (FECHA, PRODUCTO, cantidad) VALUES ('29/04/2014',2,200);
INSERT INTO dbo.STOCKS (FECHA, PRODUCTO, cantidad) VALUES ('04/05/2014',3,14);
INSERT INTO dbo.STOCKS (FECHA, PRODUCTO, cantidad) VALUES ('17/05/2014',4,2);
INSERT INTO dbo.STOCKS (FECHA, PRODUCTO, cantidad) VALUES ('31/05/2014',5,120);
INSERT INTO dbo.STOCKS (FECHA, PRODUCTO, cantidad) VALUES ('02/06/2014',6,1400);
INSERT INTO dbo.STOCKS (FECHA, PRODUCTO, cantidad) VALUES ('23/04/2014',7,2100);

SELECT * FROM STOCKS;



CREATE TABLE PROVINCIAS
(
PROVINCIA INT,
descripcion VARCHAR(100) NOT NULL,
PAIS INT,
CONSTRAINT PK_PROVINCIA PRIMARY KEY (PROVINCIA),
CONSTRAINT FK_PAIS FOREIGN KEY (PAIS) REFERENCES PAISES(PAIS)
)


INSERT INTO dbo.PROVINCIAS (PROVINCIA, descripcion, PAIS) VALUES (1,'CAPITAL FEDERAL',1);
INSERT INTO dbo.PROVINCIAS (PROVINCIA, descripcion, PAIS) VALUES (2,'CORDOBA',1);
INSERT INTO dbo.PROVINCIAS (PROVINCIA, descripcion, PAIS) VALUES (3,'CORRIENTES',1);
INSERT INTO dbo.PROVINCIAS (PROVINCIA, descripcion, PAIS) VALUES (4,'MENDOZA',1);
INSERT INTO dbo.PROVINCIAS (PROVINCIA, descripcion, PAIS) VALUES (5,'NEUQUEN',1);
INSERT INTO dbo.PROVINCIAS (PROVINCIA, descripcion, PAIS) VALUES (6,'SAO PABLO',2);
INSERT INTO dbo.PROVINCIAS (PROVINCIA, descripcion, PAIS) VALUES (7,'CURITIBA',2);
INSERT INTO dbo.PROVINCIAS (PROVINCIA, descripcion, PAIS) VALUES (8,'FLORIANOPOLIS',2);
INSERT INTO dbo.PROVINCIAS (PROVINCIA, descripcion, PAIS) VALUES (9,'RIO DE JANEIRO',2);
INSERT INTO dbo.PROVINCIAS (PROVINCIA, descripcion, PAIS) VALUES (10,'PORTO ALEGRE',2);
INSERT INTO dbo.PROVINCIAS (PROVINCIA, descripcion, PAIS) VALUES (11,'SAO GABRIEL',2);

SELECT * FROM PROVINCIAS;



CREATE TABLE LOCALIDADES
(
LOCALIDAD INT,
descripcion VARCHAR(100) NOT NULL,
PROVINCIA INT,
CONSTRAINT PK_LOCALIDAD PRIMARY KEY (LOCALIDAD),
CONSTRAINT FK_PROVINCIA_LOCALIDADES FOREIGN KEY (PROVINCIA) REFERENCES PROVINCIAS(PROVINCIA)
)


INSERT INTO dbo.LOCALIDADES (LOCALIDAD, descripcion, PROVINCIA) VALUES (1,'FLORES',1);
INSERT INTO dbo.LOCALIDADES (LOCALIDAD, descripcion, PROVINCIA) VALUES (2,'PALERMO',1);
INSERT INTO dbo.LOCALIDADES (LOCALIDAD, descripcion, PROVINCIA) VALUES (3,'CABALLITO',1);
INSERT INTO dbo.LOCALIDADES (LOCALIDAD, descripcion, PROVINCIA) VALUES (4,'CENTRO',1);
INSERT INTO dbo.LOCALIDADES (LOCALIDAD, descripcion, PROVINCIA) VALUES (5,'RETIRO',1);
INSERT INTO dbo.LOCALIDADES (LOCALIDAD, descripcion, PROVINCIA) VALUES (101,'BARRIO ALBERDI',2);
INSERT INTO dbo.LOCALIDADES (LOCALIDAD, descripcion, PROVINCIA) VALUES (102,'CARLOS PAZ',2);
INSERT INTO dbo.LOCALIDADES (LOCALIDAD, descripcion, PROVINCIA) VALUES (103,'CORDOBA CAPITAL',2);
INSERT INTO dbo.LOCALIDADES (LOCALIDAD, descripcion, PROVINCIA) VALUES (104,'JARDIN ESPINOZA',2);
INSERT INTO dbo.LOCALIDADES (LOCALIDAD, descripcion, PROVINCIA) VALUES (105,'OBRERO',2);
INSERT INTO dbo.LOCALIDADES (LOCALIDAD, descripcion, PROVINCIA) VALUES (201,'BARRACAO',8);
INSERT INTO dbo.LOCALIDADES (LOCALIDAD, descripcion, PROVINCIA) VALUES (202,'ZE TOSTAO',8);
INSERT INTO dbo.LOCALIDADES (LOCALIDAD, descripcion, PROVINCIA) VALUES (203,'COPACABANA',8);

SELECT * FROM LOCALIDADES;



CREATE TABLE PROVEEDORES
(
PROVEEDOR INT,
descripcion VARCHAR(100) NOT NULL,
cuit VARCHAR(45) NOT NULL,
telefono VARCHAR(45),
LOCALIDAD INT,
direccion VARCHAR(100) NOT NULL,
fecha DATETIME NOT NULL,
CONSTRAINT PK_PROVEEDOR PRIMARY KEY (PROVEEDOR),
CONSTRAINT UNIQUE_cuit UNIQUE (cuit),
CONSTRAINT FK_LOCALIDAD_PROVEEDORES FOREIGN KEY (LOCALIDAD) REFERENCES LOCALIDADES (LOCALIDAD)
)



INSERT INTO dbo.PROVEEDORES (PROVEEDOR, descripcion, cuit, telefono, LOCALIDAD, direccion, fecha) VALUES
(1, 'LEDESMA', '23-33123412-6', '4221-2211', 1, 'RIVADAVIA 2300', '23/02/2010');
INSERT INTO dbo.PROVEEDORES (PROVEEDOR, descripcion, cuit, telefono, LOCALIDAD, direccion, fecha) VALUES
(2, 'SHARPIE', '20-114888-1', '4312-9511', 3, 'AV ALBERDI 3700', '11/01/2002');
INSERT INTO dbo.PROVEEDORES (PROVEEDOR, descripcion, cuit, telefono, LOCALIDAD, direccion, fecha) VALUES
(3, 'BIC', '23-980557-6', '4221-9999', 2, 'AV ALVAREZ JONTE 200', '23/10/2010');
INSERT INTO dbo.PROVEEDORES (PROVEEDOR, descripcion, cuit, telefono, LOCALIDAD, direccion, fecha) VALUES
(4, 'UNIBALL', '11-841921-6', '4221-4518', 101, 'TINOGASTA 221', '14/09/2012');
INSERT INTO dbo.PROVEEDORES (PROVEEDOR, descripcion, cuit, telefono, LOCALIDAD, direccion, fecha) VALUES
(5, 'PRENSA', '11-123411-6', '4901-2055', 103, 'TEGUCIGALPA 20', '11/05/2000');
INSERT INTO dbo.PROVEEDORES (PROVEEDOR, descripcion, cuit, telefono, LOCALIDAD, direccion, fecha) VALUES
(6, 'STANDLER', '20-44121234-3', '4622-2100', 201, 'ALVAREZ JONTE 2900', '29/05/1977');
INSERT INTO dbo.PROVEEDORES (PROVEEDOR, descripcion, cuit, telefono, LOCALIDAD, direccion, fecha) VALUES
(7, '3M', '20-994141-4', '4612-99985', 203, 'RIVADAVIA 9000', '31/10/2011');


SELECT * FROM PROVEEDORES;



CREATE TABLE CLIENTES
(
CLIENTE INT,
descripcion VARCHAR(100) NOT NULL,
telefono VARCHAR(45),
nro_documento INT NOT NULL,
TIPO_DOCUMENTO INT,
direccion VARCHAR(100) NOT NULL,
LOCALIDAD INT,
C_FISCAL INT,
CONSTRAINT PK_CLIENTE PRIMARY KEY (CLIENTE),
CONSTRAINT FK_TIPO_DOCUMENTO_CLIENTES FOREIGN KEY (TIPO_DOCUMENTO) REFERENCES TIPOS_DOCUMENTOS (TIPO_DOCUMENTO),
CONSTRAINT FK_LOCALIDAD_CLIENTES FOREIGN KEY (LOCALIDAD) REFERENCES LOCALIDADES (LOCALIDAD),
CONSTRAINT FK_C_FISCAL_CLIENTES FOREIGN KEY (C_FISCAL) REFERENCES CONDICION_FISCAL (C_FISCAL)
)


INSERT INTO dbo.CLIENTES (CLIENTE, descripcion, telefono, nro_documento, TIPO_DOCUMENTO, direccion, LOCALIDAD, C_FISCAL)
VALUES(1, 'TITO ZAPATA', '4-9910017', 23998111, 1, 'AGUIRRE 50', 1, 1);
INSERT INTO dbo.CLIENTES (CLIENTE, descripcion, telefono, nro_documento, TIPO_DOCUMENTO, direccion, LOCALIDAD, C_FISCAL)
VALUES(2, 'ALBERTO MAMONE', '4-312-2017', 43211234, 1, 'TINOGASTA 981', 2, 2);
INSERT INTO dbo.CLIENTES (CLIENTE, descripcion, telefono, nro_documento, TIPO_DOCUMENTO, direccion, LOCALIDAD, C_FISCAL)
VALUES(3, 'ROBERTO TROTTA', '4-441-2211', 43234234, 2, 'VICTOR MARTINEZ 2000', 3, 1);
INSERT INTO dbo.CLIENTES (CLIENTE, descripcion, telefono, nro_documento, TIPO_DOCUMENTO, direccion, LOCALIDAD, C_FISCAL)
VALUES(4, 'VICTOR ZAPATA', '4-111-3351', 155431122, 4, 'ARGERICH 21', 101, 3);
INSERT INTO dbo.CLIENTES (CLIENTE, descripcion, telefono, nro_documento, TIPO_DOCUMENTO, direccion, LOCALIDAD, C_FISCAL)
VALUES(5, 'JONNHY RAMONE', '4-441-1184', 54231232, 3, 'ALTOLAGUIRRE 750', 202, 3);


CREATE TABLE COMPRAS_CABECERA
(
fecha DATETIME NOT NULL,
PROVEEDOR INT,
TIPO VARCHAR(3),
FACTURA INT,
CONSTRAINT PK_TIPO_FACTURA_CC PRIMARY KEY (TIPO,FACTURA),
CONSTRAINT CK_TIPO_CC CHECK (TIPO = 'A`' OR TIPO = 'B' OR TIPO = 'C'),
CONSTRAINT FK_PROVEEDOR_CC FOREIGN KEY (PROVEEDOR) REFERENCES PROVEEDORES (PROVEEDOR)
)


INSERT INTO dbo.COMPRAS_CABECERA (fecha, PROVEEDOR, TIPO, FACTURA) VALUES ('23/02/2010', 1, 'B', 221449614);
INSERT INTO dbo.COMPRAS_CABECERA (fecha, PROVEEDOR, TIPO, FACTURA) VALUES ('02/07/2011', 1, 'B', 5312543);
INSERT INTO dbo.COMPRAS_CABECERA (fecha, PROVEEDOR, TIPO, FACTURA) VALUES ('14/11/2012', 1, 'B', 65423415);
INSERT INTO dbo.COMPRAS_CABECERA (fecha, PROVEEDOR, TIPO, FACTURA) VALUES ('18/06/2013', 2, 'C', 45166721);
INSERT INTO dbo.COMPRAS_CABECERA (fecha, PROVEEDOR, TIPO, FACTURA) VALUES ('23/02/2014', 3, 'C', 312413123);
INSERT INTO dbo.COMPRAS_CABECERA (fecha, PROVEEDOR, TIPO, FACTURA) VALUES ('05/05/2014', 7, 'A', 4423455);
INSERT INTO dbo.COMPRAS_CABECERA (fecha, PROVEEDOR, TIPO, FACTURA) VALUES ('28/05/2014', 5, 'A', 5621124);



CREATE TABLE COMPRAS_DETALLE
(
PRODUCTO INT,
TIPO VARCHAR(3),
FACTURA INT,
cantidad INT NOT NULL,
precio FLOAT NOT NULL,
CONSTRAINT PK_PTF_CD PRIMARY KEY (PRODUCTO,TIPO,FACTURA),
CONSTRAINT FK_PRODUCTO_CD FOREIGN KEY (PRODUCTO) REFERENCES PRODUCTOS (PRODUCTO),
CONSTRAINT FK_TIPO_FACTURA_CD FOREIGN KEY (TIPO,FACTURA) REFERENCES COMPRAS_CABECERA (TIPO,FACTURA),
)



INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (1,'B', 221449614, 10, 250.25);
INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (2,'B', 221449614, 2, 1200.00);
INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (4,'B', 221449614, 100, 40.99);
INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (5,'B', 221449614, 19, 878.17);


INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (2,'B', 5312543, 12, 341.10);
INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (5,'B', 5312543, 60, 410.55);
INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (1,'B', 5312543, 340, 22.37);
INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (4,'B', 5312543, 59, 290.00);



INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (2,'B', 65423415, 12, 341.10);
INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (5,'B', 65423415, 60, 410.55);
INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (1,'B', 65423415, 340, 22.37);
INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (4,'B', 65423415, 59, 290.00);



INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (1,'C', 45166721, 19, 5600.00);
INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (2,'C', 45166721, 4, 20010.25);
INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (7,'C', 45166721, 340, 122.77);
INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (3,'C', 45166721, 1, 1790.00);



INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (7,'C', 312413123, 2, 700.00);
INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (3,'C', 312413123, 5, 41.00);
INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (4,'C', 312413123, 100, 56.14);
INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (5,'C', 312413123, 44, 23.20);



INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (6,'A', 4423455, 17, 288.88);
INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (4,'A', 4423455, 59, 2104.00);
INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (1,'A', 4423455, 45, 221.22);
INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (2,'A', 4423455, 360, 411.07);



INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (1,'A', 5621124, 5, 21.88);
INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (2,'A', 5621124, 1, 662.00);
INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (3,'A', 5621124, 1, 21.99);
INSERT INTO dbo.COMPRAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (6,'A', 5621124, 4, 7890);



CREATE TABLE VENTAS_CABECERA
(
fecha DATETIME NOT NULL,
CLIENTE INT,
TIPO VARCHAR(3),
FACTURA INT,
CONSTRAINT PK_TIPO_FACTURA_VC PRIMARY KEY (TIPO,FACTURA),
CONSTRAINT FK_CLIENTE_VC FOREIGN KEY (CLIENTE) REFERENCES CLIENTES (CLIENTE),
CONSTRAINT CK_TIPO_VC CHECK (TIPO = 'A' OR TIPO = 'B' OR TIPO = 'C')
)



INSERT INTO dbo.VENTAS_CABECERA (fecha, CLIENTE, TIPO, FACTURA) VALUES
('23/02/2010',1,'A', 4418882);
INSERT INTO dbo.VENTAS_CABECERA (fecha, CLIENTE, TIPO, FACTURA) VALUES
('14/10/2012',3,'B', 312313);
INSERT INTO dbo.VENTAS_CABECERA (fecha, CLIENTE, TIPO, FACTURA) VALUES
('29/06/2013',5,'C', 555211);
INSERT INTO dbo.VENTAS_CABECERA (fecha, CLIENTE, TIPO, FACTURA) VALUES
('04/05/2014',1,'A', 777734523);



CREATE TABLE VENTAS_DETALLE
(
PRODUCTO INT,
TIPO VARCHAR(3),
FACTURA INT,
cantidad INT NOT NULL,
precio FLOAT NOT NULL,
CONSTRAINT PK_PRODUCTO_TIPO_FACTURA_VD PRIMARY KEY (PRODUCTO,TIPO,FACTURA),
CONSTRAINT FK_PRODUCTO_VD FOREIGN KEY (PRODUCTO) REFERENCES PRODUCTOS (PRODUCTO),
CONSTRAINT FK_TIPO_FACTURA_VD FOREIGN KEY (TIPO,FACTURA) REFERENCES VENTAS_CABECERA (TIPO,FACTURA)
)



INSERT INTO dbo.VENTAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (1, 'A', 4418882, 22, 230.99);
INSERT INTO dbo.VENTAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (2, 'A', 4418882, 11, 14.08);
INSERT INTO dbo.VENTAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (7, 'A', 4418882, 150, 1900.22);
INSERT INTO dbo.VENTAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (5, 'A', 4418882, 18, 23090.00);



INSERT INTO dbo.VENTAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (4, 'B', 312313, 1, 9800.00);
INSERT INTO dbo.VENTAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (5, 'B', 312313, 5, 1400.18);
INSERT INTO dbo.VENTAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (1, 'B', 312313, 900, 40.55);
INSERT INTO dbo.VENTAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (2, 'B', 312313, 1, 231.90);



INSERT INTO dbo.VENTAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (1, 'C', 555211, 1, 200.00);
INSERT INTO dbo.VENTAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (2, 'C', 555211, 5, 400.18);
INSERT INTO dbo.VENTAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (3, 'C', 555211, 14, 540.55);
INSERT INTO dbo.VENTAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (6, 'C', 555211, 7, 69.99);



INSERT INTO dbo.VENTAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (7, 'A', 777734523, 20, 310.00);
INSERT INTO dbo.VENTAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (2, 'A', 777734523, 519, 300.58);
INSERT INTO dbo.VENTAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (1, 'A', 777734523, 15, 124.99);
INSERT INTO dbo.VENTAS_DETALLE (PRODUCTO, TIPO, FACTURA, cantidad, precio)
VALUES (3, 'A', 777734523, 77, 12.08);




//Traer CODIGO DE CLIENTE, Nombre de CLIENTE, NRO de Factura y fecha de los clientes que compraron
entre el 01-01-2000 y el 31-12-2014

select v.CLIENTE, c.descripcion, v.FACTURA, V.fecha
from VENTAS_CABECERA v
INNER JOIN CLIENTES c ON v.CLIENTE = c.CLIENTE
where v.fecha between '2000-01-01'and '2014-31-12';


